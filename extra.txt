#app.py 
with st.sidebar:
        st.title("Settings")
        
        # ---> ADD THE START OVER BUTTON HERE
        if st.button("üîÑ Start Over / Reset App", type="secondary", use_container_width=True):
            st.session_state.clear()
            st.rerun()
            
        st.divider()

##small-scale recap
"""step-3
def render_step_3(self, mgr, config):
        render_persistent_header()
        st.header(f"Step 3: Configuration for {st.session_state.current_tab}")
        
        # 1. Wrap inputs in a form to prevent UI lag
        with st.form("config_form"):
            # Call your date input component
            dates = render_date_inputs() 
            
            st.subheader("Amounts")
            col1, col2 = st.columns(2)
            with col1:
                p4_val = st.number_input("P4 Qualify Amount", min_value=0.0, step=1.0)
            with col2:
                q4_val = st.number_input("Q4 Redeem Amount", min_value=0.0, step=1.0)
                
            # File upload component
            st.subheader("Article List")
            uploaded_file = render_article_upload()
            
            # 2. Form Submit Button
            submitted = st.form_submit_button("Save Inputs & Generate SQL", type="primary")
            
        # 3. Validation & Processing (Only runs when clicked!)
        if submitted:
            # --- VALIDATION CHECKS ---
            if dates['ty_q_start'] > dates['ty_q_end']:
                st.error("‚ùå TY Qualify Start date cannot be after the End date!")
                return
            if dates['ly_q_start'] > dates['ly_q_end']:
                st.error("‚ùå LY Qualify Start date cannot be after the End date!")
                return
            if p4_val <= 0 and q4_val <= 0:
                st.warning("‚ö†Ô∏è Did you forget to enter a Qualification or Redemption Amount?")
                return
            if not uploaded_file:
                st.error("‚ùå Please upload an article list to proceed.")
                return
                
            # --- PROCESSING (With a Loading Spinner!) ---
            with st.spinner("Processing file and writing inputs to Excel..."):
                # Write Dates to Excel
                mgr.write_cell(st.session_state.current_tab, config['mappings']['ty_q_start'], dates['ty_q_start'].strftime('%m/%d/%Y'))
                mgr.write_cell(st.session_state.current_tab, config['mappings']['ty_q_end'], dates['ty_q_end'].strftime('%m/%d/%Y'))
                # (... add the rest of your date writes here)
                
                # Write Amounts to Excel
                mgr.write_cell(st.session_state.current_tab, config['mappings']['p4_qualify_amt'], p4_val)
                mgr.write_cell(st.session_state.current_tab, config['mappings']['q4_redeem_amt'], q4_val)
                
                # Handle Article List processing
                uploaded_file.seek(0) 
                if uploaded_file.name.endswith('csv'):
                    df = pd.read_csv(uploaded_file, header=None)
                else:
                    # Note: Assumes selected_article_sheet is returned by render_article_upload, or adjust as needed.
                    df = pd.read_excel(uploaded_file, header=None) 
                
                if df.shape[1] >= 6:
                    f1_raw = df.iloc[0, 5]
                    if pd.notna(f1_raw):
                        st.session_state.sql_article_tuple = str(f1_raw)

                # Dynamically name and write the item list tab safely
                clean_tab_name = re.sub(r'[\\/*?:\[\]]', '', st.session_state.current_tab)
                item_sheet_name = f"Items_{clean_tab_name}"[:31]
                mgr.overwrite_item_list(item_sheet_name, df)
                
                # Move to next step
                st.success("Inputs saved successfully!")
                time.sleep(0.5) # Brief pause so the user sees the success message
                st.session_state.step = 4
                st.rerun()

"""step 5
if st.button("Complete Analysis", type="primary"):
            if sql_output_str:
                with st.spinner("Formatting Data and Updating Workbook..."):
                    # 1. Split the text area into separate lines
                    raw_lines = [line for line in sql_output_str.strip().split('\n') if line.strip()]
                    
                    # ... (Keep all your existing parsing and Excel writing code here exactly as is) ...
                    
                    st.success(f"Analysis complete for {st.session_state.current_tab}! SQL & Data saved.")
                    time.sleep(1) # Let them read the success message
                    st.session_state.step = 6 
                    st.rerun()
